<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout/header :: header(~{::title})">
    <meta charset="UTF-8">
    <title>后台管理主页</title>
</head>
<body>
<div th:replace="layout/body :: public"></div>
<div class="container-fluid">
    <div class="row">
        <div th:replace="layout/body :: public1"></div>
        <div id="app">
            <div v-for="i in metricsValue ">
                <span v-if="i.name == 'disk.free'">空闲内存:{{i.value}}</span>
                <!--    {{i.name}}:{{i.value}}-->
            </div>

        </div>

    </div>
</div>
</body>
<script src="/js/vue.js"></script>
<script src="/js/axios.js"></script>
<script src="/js/elementui.js"></script>
<script>
    var v = new Vue({
        el:"#app",
        data:{
            metricsKey:[],
            metricsValue:[{}],

        },
        methods:{
            find(){
                axios.get("/resfood/actuator/metrics/").then(res=>{
                    this.metricsKey.push(
                        res.data.names[2],  // "disk.free"
                        (res.data.names[3]), //"disk.total"
                        (res.data.names[22]),//"jvm.memory.committed"
                        (res.data.names[23]),//"jvm.memory.max"
                        (res.data.names[25]), //"jvm.memory.used"
                        (res.data.names[35]), //"process.cpu.usage"
                        (res.data.names[39]), //"system.cpu.usage"
                    );
                    console.info(res.data);
                })
                console.log(this.metricsKey)
            },
            find1(){
                axios.get("/resorder/actuator/metrics/"+this.metricsKey[0]).then(res=>{
                    console.log("i:"+JSON.stringify(res.data));
                    console.log("name:"+res.data.name);
                    console.log("measurements:"+res.data.measurements[0].value);
                    let json = {name:res.data.name,value:res.data.measurements[0].value}
                    this.metricsValue.push(json);
                    console.log(json)
                })
            },
            find2(){
                console.info(this.metricsKey[1]);
                axios.get("/resuser/actuator/metrics/"+this.metricsKey[1]).then(res=>{
                    console.log("i:"+JSON.stringify(res.data));
                    console.log("name:"+res.data.name);
                    console.log("measurements:"+res.data.measurements[0].value);

                    let json = {name:res.data.name,value:res.data.measurements[0].value}
                    this.metricsValue.push(json);
                    console.log(json)
                })
            }
        },
        created(){
            this.find();
            // setTimeout(()=>{
            //     this.find1();
            //     this.find2();
            // },100)
        }
    })
</script>
</html>